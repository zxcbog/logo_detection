# Детекция логотипа Т-Банка с помощью YOLOv11

## О проекте

Этот проект представляет собой микросервис для автоматического обнаружения логотипа Т-Банка на изображениях. Сервис использует модель YOLOv11, обученную на специально подготовленном датасете, и предоставляет REST API интерфейс для выполнения инференса.

## Подход к решению

### 1. Подготовка данных

Для обучения модели был создан комбинированный датасет, состоящий из:

- Готового датасета с Roboflow

- Автоматически сгенерированных синтетических данных, используя наложения лого Т-Банка на поверхности случайных сцен.

Датасет был тщательно аннотирован с фокусом на логотип Т-Банка (стилизованная буква "Т" в щите), при этом логотипы "Тинькофф" были исключены из рассмотрения.

### 2. Кастомные аугментации

Для увеличения разнообразия данных и улучшения обобщающей способности модели были применены кастомные аугментации:

- Наложение логотипов на случайные сцены с учетом перспективы

- Восстановление геометрии пространства с помощью создания карты глубины

- Поиск и учет поверхностей для реалистичного размещения логотипов

- Цветовые преобразования для учета различных вариантов цветового оформления логотипа

В качестве depth-estimator модели была использована модель трансформерная DepthAnything

### 3. Обучение модели

Модель **YOLOv11** была обучена с использованием:

- Transfer learning на предобученных весах

- Оптимизированных гиперпараметров

- Расширенного набора аугментаций

## Инструкции по запуску

### Предварительные требования

- Docker и Docker Compose

- NVIDIA Container Toolkit (для использования GPU)

### Запуск с помощью Docker Compose

```bash
git clone https://github.com/zxcbog/logo_detection.git
```

```bash
docker-compose up --build
```
Сервис будет доступен по адресу: http://localhost:8000

## Использование API
### Эндпоинт детекции

POST /detect

Принимает изображение в формате JPEG, PNG, BMP или WEBP и возвращает координаты обнаруженных логотипов.

Пример запроса с помощью curl:

```bash
curl -X POST "http://localhost:8000/detect" \
  -H "accept: application/json" \
  -H "Content-Type: multipart/form-data" \
  -F "file=@test_image.jpg"
```

Пример ответа:
```json
{
  "detections": [
    {
      "bbox": {
        "x_min": 100,
        "y_min": 150,
        "x_max": 200,
        "y_max": 250
      }
    }
  ]
}
```

## Структура проекта

```project/
├── main.py                 # Основной файл FastAPI приложения
├── Dockerfile             # Конфигурация Docker
├── docker-compose.yml     # Конфигурация Docker Compose
├── requirements.txt       # Зависимости Python
├── best.pt               # Веса обученной модели YOLO
├── test_images/          # Тестовые изображения
├── examples/             # Примеры работы модели
└── README.md             # Документация
```

## Особенности реализации

- Поддержка асинхронной обработки запросов

- Оптимизированная работа с памятью при обработке изображений

- Гибкая конфигурация через переменные окружения

- Поддержка GPU для ускорения инференса

- Подробное логирование и обработка ошибок

## Возможные улучшения

- Увеличение числа изображений с кастомной аугментацией, а также улучшение алгоритма генерации синтетических данных

- Добавление аутентификации и авторизации

- Реализация батчевой обработки изображений

- Добавление метрик производительности

- Интеграция с системами мониторинга

- Поддержка дополнительных форматов вывода (XML, COCO, etc.)

## Результаты:

![1](https://github.com/zxcbog/logo_detection/images/-2025-09-15-164129_png.rf.9db54b37d28b01254b8d5e1dfc8c9ac4.jpg.png)
![2](https://github.com/zxcbog/logo_detection/images/-2025-09-15-164156_png.rf.3501a12c9aa5d76eae6e6ff10212fab7.jpg)
![3](https://github.com/zxcbog/logo_detection/images/2a2ddce6808abbd417ad36e246a3e604_jpg.rf.c637605c93b0125f621804d7ca9c3fcc.jpg)